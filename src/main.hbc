include devices.hbh;
include endpoints.hbh;

# programs
module lamp_switch($POS_THRESHOLD, $NEG_THRESHOLD, $LAMP) {
	states { init, on }
	in(init) {
		if(ep notebook.power_balance > $POS_THRESHOLD) {
			write $LAMP.power := 1;
			goto on;
		}
	}
	in(on) {
		if(ep notebook.power_balance < $NEG_THRESHOLD) {
			write $LAMP.power := 0;
			goto init;
		}
	}
}

instance demo : lamp_switch(+10, -10, lamp_a);
